apiVersion: apiextensions.crossplane.io/v1
kind: CompositeResourceDefinition
metadata:
  name: xmetakubeclusters.platform.example.com
spec:
  group: platform.example.com
  names:
    kind: XMetaKubeCluster
    plural: xmetakubeclusters
  claimNames:
    kind: MetaKubeCluster
    plural: metakubeclusters
  versions:
  - name: v1alpha1
    served: true
    referenceable: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              parameters:
                type: object
                description: MetaKube cluster parameters
                properties:
                  projectId:
                    type: string
                    description: MetaKube project ID
                  dcName:
                    type: string
                    description: Datacenter name (e.g., syseleven-dus2)
                    default: syseleven-dus2
                  kubernetesVersion:
                    type: string
                    description: Kubernetes version
                    default: "1.31.1"
                  cloudProvider:
                    type: string
                    description: Cloud provider (openstack, aws, azure)
                    default: openstack
                    enum:
                    - openstack
                    - aws
                    - azure
                  nodeCount:
                    type: integer
                    description: Number of worker nodes
                    default: 3
                  nodeSize:
                    type: string
                    description: Node size/flavor
                    default: m2.small
                  nodeImage:
                    type: string
                    description: Node operating system image
                    default: "Ubuntu Jammy 22.04"
                required:
                - projectId
            required:
            - parameters
          writeConnectionSecretToRef:
            type: object
            description: Reference where the cluster connection details will be written
            properties:
              name:
                type: string
                description: Secret name
              namespace:
                type: string
                description: Secret namespace
          status:
            type: object
            properties:
              clusterId:
                type: string
                description: The MetaKube cluster ID
              clusterEndpoint:
                type: string
                description: The Kubernetes API endpoint
              ready:
                type: boolean
                description: Whether the cluster is ready
